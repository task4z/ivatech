import { HttpClient } from '@angular/common/http';
import { TestBed } from '@angular/core/testing';
import { of } from 'rxjs';
import { OrdersHelper } from 'src/app/models/orders-helper.model';
import { Orders } from 'src/app/models/orders.model';

import { OrdersService } from './orders.service';

describe('OrdersService', () => {
  let service: OrdersService;

  let httpClientSpy: jasmine.SpyObj<HttpClient>;
  beforeEach(() => {
    httpClientSpy = jasmine.createSpyObj('HttpClient', ['get']);
    TestBed.configureTestingModule({
      providers: [
        { provide: HttpClient, useValue: httpClientSpy },
      ]
    });
    service = TestBed.inject(OrdersService);
  });

  it('should be created', () => {
    expect(service).toBeTruthy();
  });

  it('should return expected orders (HttpClient called once)', (done: DoneFn) => {
    const returnedOrders: Orders = {
      orders: [{
        created_at: "2020-01-27T13:50:52.429632", currency: "$", customer: { address: { city: "Plant City", street: "Brooklyn", zipcode: "53070" }, id: "0d2fb16a-34cd-03f1-cfa7-6fef1ca48812", name: "Nyla", surname: "Delaney" }, id: "7b4f0a0c-dfc9-1632-68b3-221b8341ab80", product: { id: "8faac23f-22df-2f71-8544-53de77868556", image: "https://images.unsplash.com/photo-1581053462058-9c89df7d26e9?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NzE1&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Castle Realty Asarabacca Bacuri Pretzels", quantity: 93 }, status: "delivered", total: 2419
      }, {
        created_at: "2020-04-24T16:28:54.708495", currency: "$", customer: { address: { city: "Allentown", street: "Emerson", zipcode: "46067" }, id: "132d8f8d-cc4a-0d70-89ba-d01f955ad64f", name: "Titus", surname: "Mclaughlin" }, id: "fb9d5660-7ac5-1304-53a2-61a43b2cf98a", product: { id: "d76ecedb-b76e-baba-c6de-f74decf65461", image: "https://images.unsplash.com/photo-1601493701002-3223e7e1ebaf?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NzM5&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Mission Realty Cassia Bacupari Pretzels", quantity: 30 }, status: "shipped", total: 3743
      }, {
        created_at: "2020-01-04T21:44:02.384147", currency: "$", customer: { address: { city: "Attleboro", street: "Ardenwood", zipcode: "72765" }, id: "a6cbc33b-14e4-8086-7ce4-1fc3defcaab8", name: "Fe", surname: "Bush" }, id: "819a32c2-b260-1f97-f5cb-ad39d409b4ae", product: { id: "1d158ec1-187c-62cc-ccf8-4304b21464bc", image: "https://images.unsplash.com/photo-1518691340140-512e66ce957b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NzYy&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Www Realty Annatto Bolivian Pretzels", quantity: 68 }, status: "delivered", total: 7843
      }, {
        created_at: "2021-03-28T14:52:39.355611", currency: "$", customer: { address: { city: "Carteret", street: "Sal", zipcode: "85765" }, id: "4104bb57-88de-a291-9542-4d27f656b27c", name: "Dewitt", surname: "Jenkins" }, id: "8c90df31-2c1b-cf21-74b7-21e790e3ad63", product: { id: "3659e689-10ef-9e17-6f44-151b4860707a", image: "https://images.unsplash.com/photo-1565507411039-8c2af0e21b5d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1Nzk2&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Castle Realty Pepper Keule Drops", quantity: 32 }, status: "delivered", total: 8479
      }, {
        created_at: "2021-10-01T01:36:25.343195", currency: "$", customer: { address: { city: "Oregon", street: "Stanford", zipcode: "69023" }, id: "c56a6323-3f29-fc05-4443-8cad3884c28c", name: "Diedre", surname: "Clay" }, id: "f2cd3ef7-ebd3-7c4b-fedc-f97cbac0c284", product: { id: "7e2de537-3ef2-7a92-6b73-aaa4630e50ff", image: "https://images.unsplash.com/photo-1627494106635-41f3669d0e4e?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODIx&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Modern Realty Alkanet Partridgeberry Snack", quantity: 5 }, status: "processing", total: 4184
      }, {
        created_at: "2021-01-21T23:48:59.833008", currency: "$", customer: { address: { city: "Columbia", street: "Maryland", zipcode: "69768" }, id: "bdacacd4-8fdd-a29f-ee5b-35b41cc58689", name: "Reda", surname: "Conrad" }, id: "d0d30593-28d6-14f1-e30d-5e099e07b4ea", product: { id: "70015450-e714-31b8-a325-023423ef4dfb", image: "https://images.unsplash.com/photo-1611197072011-736d9b407c8b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODc1&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Mission Realty Jimbu Bolwarra Bar", quantity: 95 }, status: "delivered", total: 4756
      }, {
        created_at: "2020-11-15T13:35:05.318909", currency: "$", customer: { address: { city: "Terrell", street: "James", zipcode: "38708" }, id: "59457541-8de8-df29-8f09-18f396b29cc7", name: "Toshia", surname: "Parrish" }, id: "572bfe0e-5c00-8567-8ece-2c1f8c1bd667", product: { id: "ddd22785-e471-6154-1870-7cb871157c96", image: "https://images.unsplash.com/photo-1611197072011-736d9b407c8b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODc4&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Castle Realty Jiaogulan Longan Drops", quantity: 52 }, status: "processing", total: 6837
      }, {
        created_at: "2021-09-02T14:45:02.289483", currency: "$", customer: { address: { city: "Brigham City", street: "Wetmore", zipcode: "93833" }, id: "d25f4966-2c02-a888-da29-46ad624bae82", name: "Krysten", surname: "Terry" }, id: "bc942a38-22b1-6cd9-df40-02862a8dbeb6", product: { id: "078540f5-8949-cd71-728a-017870bcaaca", image: "https://images.unsplash.com/photo-1574857123186-5a45cf918635?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODg5&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Realty Zone Chervil Dewberry Gummies", quantity: 70 }, status: "delivered", total: 1496
      }, {
        created_at: "2020-03-22T16:23:44.196413", currency: "$", customer: { address: { city: "Naugatuck", street: "Capp", zipcode: "34757" }, id: "2625f845-0cc6-6c19-1558-76289eb5ee29", name: "Alease", surname: "Sellers" }, id: "894cfde5-9422-b600-11be-85d11e1cf7f0", product: { id: "8d7c7ff8-ced2-fe6c-f353-2c66800ca5dd", image: "https://images.unsplash.com/photo-1581700261299-b342aa7174cf?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM2MDAw&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Solution Realty Cudweed Redcurrant Drops", quantity: 21 }, status: "delivered", total: 8120
      }, {
        created_at: "2021-04-23T05:12:32.686521", currency: "$", customer: { address: { city: "Missoula", street: "Cameron", zipcode: "64459" }, id: "e032e955-544e-eaf8-0973-590e0b15d174", name: "Stasia", surname: "Miles" }, id: "85e3d8c9-50e2-2175-0296-c5f40b1250ab", product: { id: "d62a155e-b007-e2d4-aefe-6dd0030e27a3", image: "https://images.unsplash.com/photo-1524062850143-d314efa60f57?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1Njc3&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Mission Realty Curry Plant Tayberry Pretzels", quantity: 19 }, status: "shipped", total: 2053
      }, {
        created_at: "2020-05-21T08:44:05.301068", currency: "$", customer: { address: { city: "Hopkins", street: "Easement", zipcode: "56161" }, id: "1ff00778-1092-6785-ee62-96ad0c06d919", name: "Ezra", surname: "Franco" }, id: "6a657f25-0ee2-d93b-ded8-063e6d5a8a78", product: { id: "8c2aedf9-e3d9-2f59-f204-b3b50c2d6d38", image: "https://images.unsplash.com/photo-1601493701002-3223e7e1ebaf?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NzM4&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Solution Realty Saigon Cinnamon Citron Pretzels", quantity: 15 }, status: "processing", total: 8996
      }, {
        created_at: "2020-03-07T15:55:18.903678", currency: "$", customer: { address: { city: "Desert Hot Springs", street: "Whitecliff", zipcode: "78187" }, id: "8c02b778-c404-9bf5-420c-8b34b6d54a05", name: "Adam", surname: "Powell" }, id: "54379288-7a24-5a93-b0d5-b191a2a28a74", product: { id: "ab3071e4-04f1-b154-e787-051b92ad5a23", image: "https://images.unsplash.com/photo-1518691340140-512e66ce957b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1Nzcz&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Destiny Realty Asafoetida Black Cherry Pretzels", quantity: 46 }, status: "delivered", total: 7014
      }, {
        created_at: "2021-10-09T19:04:23.113521", currency: "$", customer: { address: { city: "Park Forest", street: "Lomita", zipcode: "05739" }, id: "bea8c3c2-52d8-f6ed-c166-42a97b587a67", name: "Efren", surname: "Duke" }, id: "ed00f2d6-5ec7-c5c0-c588-419c22540e3e", product: { id: "7f666eaf-255d-a61d-044c-6d8f0c1bba95", image: "https://images.unsplash.com/photo-1569670554366-dd3858903ac3?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODcx&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Exact Realty Lime Flower Keule Gummies", quantity: 70 }, status: "delivered", total: 6541
      }, {
        created_at: "2021-11-02T13:42:13.656654", currency: "$", customer: { address: { city: "Safety Harbor", street: "Presidio", zipcode: "57861" }, id: "851b44d8-bca4-d877-05fe-ae7e316a10c3", name: "Lavera", surname: "Dennis" }, id: "143f01b1-a452-330e-f0a8-48a423535df8", product: { id: "c0762d92-820f-ea46-decd-f7393a68b58f", image: "https://images.unsplash.com/photo-1519087318609-bfb5c04c27f5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1ODk4&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Omni Realty Pandan Flower Fragaria Candy", quantity: 53 }, status: "shipped", total: 4012
      }, {
        created_at: "2020-03-30T09:55:44.050539", currency: "$", customer: { address: { city: "White Bear Lake", street: "Valmar", zipcode: "60375" }, id: "597e6b3f-bb71-334b-fb45-45b15779a5ce", name: "Ray", surname: "Hyde" }, id: "f19d173e-0d64-4457-66e6-77b73371fb3f", product: { id: "a4e72ea8-1a9c-748e-319a-37bcbbfc4f25", image: "https://images.unsplash.com/photo-1627494106635-41f3669d0e4e?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1OTU5&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Realty Solution Cayenne Pepper Berberis Bar", quantity: 99 }, status: "processing", total: 9945
      }, {
        created_at: "2020-05-11T23:57:09.744041", currency: "$", customer: { address: { city: "Arroyo Grande", street: "Frederick", zipcode: "32949" }, id: "7e166a5a-2423-0868-3fa2-c5faa475ec5f", name: "Earnest", surname: "Mccoy" }, id: "9223d7cc-f6a3-dd38-e027-36d5170e9587", product: { id: "55e5927b-cbdd-1cf5-89c3-e37db55fbe50", image: "https://images.unsplash.com/photo-1626980714826-ad7bf460a027?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1OTcz&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "One-Up Realty Salep Bael Bar", quantity: 74 }, status: "processing", total: 9909
      }, {
        created_at: "2021-06-08T08:50:14.622596", currency: "$", customer: { address: { city: "Los Altos", street: "Nueva", zipcode: "40967" }, id: "a6e461b2-7124-5e66-0601-2941530a15ea", name: "Gino", surname: "Robinson" }, id: "3bd74981-29fa-6860-4b4a-2ea2070802c0", product: { id: "c42db595-112c-c3a6-dc77-c203115436f9", image: "https://images.unsplash.com/photo-1498940757830-82f7813bf178?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1OTc5&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Omni Realty Juniper Berry Dragonfrui Gummies", quantity: 79 }, status: "shipped", total: 3168
      }, {
        created_at: "2020-04-09T00:06:31.358796", currency: "$", customer: { address: { city: "Albany", street: "Robinson", zipcode: "68495" }, id: "6edc6c3f-0a0f-bf21-72c5-ac607d234645", name: "Stephan", surname: "Ramirez" }, id: "5d74e959-bb4a-556a-c445-9fc90eeb40d4", product: { id: "11dc8012-1037-3fd2-e0ed-d0dcee2e50c9", image: "https://images.unsplash.com/photo-1533602933119-70608e48905d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NjU5&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Alladin Realty Salad Burnet Horned Melon Drops", quantity: 63 }, status: "delivered", total: 4599
      }, {
        created_at: "2021-09-17T12:47:04.549067", currency: "$", customer: { address: { city: "Hastings", street: "Avenue M", zipcode: "97599" }, id: "1b6aad2e-c7d5-d916-9926-1d7228a49da9", name: "Orville", surname: "Good" }, id: "fc516f8a-034e-ec8c-bc0e-60a692a476da", product: { id: "d89156f8-695b-c489-02fd-114b848daa2c", image: "https://images.unsplash.com/photo-1518691340140-512e66ce957b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1NzYy&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "New World Realty Clove Cloudberry Cotton Candy", quantity: 25 }, status: "delivered", total: 8989
      }, {
        created_at: "2021-10-19T20:05:35.915188", currency: "$", customer: { address: { city: "Foster City", street: "Munich", zipcode: "28709" }, id: "cd1d16ba-84a0-32c9-0a25-6e0ba4630557", name: "Shala", surname: "Ferguson" }, id: "3fbf9165-d1ec-90bd-e962-fe7ddcb003ee", product: { id: "ddd3968d-51af-dd72-2c27-f6f6a897657f", image: "https://images.unsplash.com/photo-1582232655383-0826ba4f1347?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&ixid=MnwxfDB8MXxyYW5kb218MHx8Y2FuZHl8fHx8fHwxNjQwNjM1OTEy&ixlib=rb-1.2.1&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=500", name: "Realty Depot Parsley Luma Apiculata Cotton Candy", quantity: 23 }, status: "shipped", total: 2711
      }],
      page: 1,
      total: 20
    };

    const expectedOrders: OrdersHelper = { orders: [{ name: "Castle Realty Asarabacca Bacuri Pretzels", date: new Date("2020-01-27T13:50:52.429Z"), price: "$26.01", status: "delivered" }, { name: "Mission Realty Cassia Bacupari Pretzels", date: new Date("2020-04-24T15:28:54.708Z"), price: "$124.77", status: "shipped" }, { name: "Www Realty Annatto Bolivian Pretzels", date: new Date("2020-01-04T21:44:02.384Z"), price: "$115.34", status: "delivered" }, { name: "Castle Realty Pepper Keule Drops", date: new Date("2021-03-28T13:52:39.355Z"), price: "$264.97", status: "delivered" }, { name: "Modern Realty Alkanet Partridgeberry Snack", date: new Date("2021-10-01T00:36:25.343Z"), price: "$836.80", status: "processing" }, { name: "Mission Realty Jimbu Bolwarra Bar", date: new Date("2021-01-21T23:48:59.833Z"), price: "$50.06", status: "delivered" }, { name: "Castle Realty Jiaogulan Longan Drops", date: new Date("2020-11-15T13:35:05.318Z"), price: "$131.48", status: "processing" }, { name: "Realty Zone Chervil Dewberry Gummies", date: new Date("2021-09-02T13:45:02.289Z"), price: "$21.37", status: "delivered" }, { name: "Solution Realty Cudweed Redcurrant Drops", date: new Date("2020-03-22T16:23:44.196Z"), price: "$386.67", status: "delivered" }, { name: "Mission Realty Curry Plant Tayberry Pretzels", date: new Date("2021-04-23T04:12:32.686Z"), price: "$108.05", status: "shipped" }, { name: "Solution Realty Saigon Cinnamon Citron Pretzels", date: new Date("2020-05-21T07:44:05.301Z"), price: "$599.73", status: "processing" }, { name: "Destiny Realty Asafoetida Black Cherry Pretzels", date: new Date("2020-03-07T15:55:18.903Z"), price: "$152.48", status: "delivered" }, { name: "Exact Realty Lime Flower Keule Gummies", date: new Date("2021-10-09T18:04:23.113Z"), price: "$93.44", status: "delivered" }, { name: "Omni Realty Pandan Flower Fragaria Candy", date: new Date("2021-11-02T13:42:13.656Z"), price: "$75.70", status: "shipped" }, { name: "Realty Solution Cayenne Pepper Berberis Bar", date: new Date("2020-03-30T08:55:44.050Z"), price: "$100.45", status: "processing" }, { name: "One-Up Realty Salep Bael Bar", date: new Date("2020-05-11T22:57:09.744Z"), price: "$133.91", status: "processing" }, { name: "Omni Realty Juniper Berry Dragonfrui Gummies", date: new Date("2021-06-08T07:50:14.622Z"), price: "$40.10", status: "shipped" }, { name: "Alladin Realty Salad Burnet Horned Melon Drops", date: new Date("2020-04-08T23:06:31.358Z"), price: "$73.00", status: "delivered" }, { name: "New World Realty Clove Cloudberry Cotton Candy", date: new Date("2021-09-17T11:47:04.549Z"), price: "$359.56", status: "delivered" }, { name: "Realty Depot Parsley Luma Apiculata Cotton Candy", date: new Date("2021-10-19T19:05:35.915Z"), price: "$117.87", status: "shipped" }], "total": 20 };

    httpClientSpy.get.and.returnValue(of(returnedOrders));

    service.getOrders('', 1).subscribe({
      next: Orders => {
        expect(Orders)
          .withContext('expected Orders')
          .toEqual(expectedOrders);
        done();
      },
      error: done.fail
    });
    expect(httpClientSpy.get.calls.count())
      .withContext('one call')
      .toBe(1);
  });
});
